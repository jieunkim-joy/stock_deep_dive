---
alwaysApply: true
---

# PRD: Stock Deep-Dive AI (MVP v1.0)

## 1. Project Overview
- **Product Name:** Stock Deep-Dive AI
- **Objective:** ê°œì¸ íˆ¬ììë¥¼ ìœ„í•œ ë°ì´í„° ê¸°ë°˜ 'Top-Down(ê±°ì‹œ) + Bottom-Up(ì¬ë¬´/ì°¨íŠ¸)' í†µí•© ì£¼ì‹ ë¶„ì„ ë„êµ¬ ê°œë°œ.
- **Key Value:** Finviz ìŠ¤í¬ë¦¬ë‹ ì´í›„, AIê°€ ì¬ë¬´ í¬ë Œì‹, ì‹œì¥ ìƒí™©, ê¸°ìˆ ì  íƒ€ì´ë°ì„ ì¢…í•© ë¶„ì„í•˜ì—¬ "ë§¤ìˆ˜ í™•ì‹ " ë° "ì§„ì… ì‹œì " ì œì•ˆ.
- **Language:** UI/Output ì „ë©´ ì˜ì–´ (English).

## 2. User Flow
1. **Input:** Ticker ì…ë ¥ (e.g., AAPL) + Strategy ì„ íƒ (Growth vs Value).
2. **Process:** ë°ì´í„° ìˆ˜ì§‘(ì¬ë¬´, ì£¼ê°€, ë‰´ìŠ¤) â†’ ì§€í‘œ ê°€ê³µ(íŒŒìƒë³€ìˆ˜) â†’ AI ì¢…í•© ë¶„ì„.
3. **Output:** 4ê°œ íƒ­ìœ¼ë¡œ êµ¬ì„±ëœ ë¶„ì„ ëŒ€ì‹œë³´ë“œ (Summary, Macro, Financials, Technicals).

## 3. Tech Stack & Libraries
- **Data Source (Market):** `yfinance` (Prices, Financials, Recent News, Calendar, Info)
- **Data Source (History):** `duckduckgo_search` (Required for finding reasons behind past price spikes/drops).
- **Analysis:** `pandas`, `pandas-ta` (Technicals), `scipy/numpy`
- **AI Engine:** Google Gemini API (`gemini-2.5-flash-lite`)

---

## 4. Functional Specifications (Data Pipeline)

### Class: `StockDataManager`
ì•„ë˜ ë©”ì„œë“œë¥¼ í¬í•¨í•˜ëŠ” ë‹¨ì¼ í´ë˜ìŠ¤ë¡œ ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•.

#### A. Basic Info & Macro (`get_profile`)
- `ticker.info` í™œìš©: Sector, Industry, Country, Market Cap, Beta.

#### B. Financial Forensic (`get_financials`)
- **Raw Data:** Income Statement, Balance Sheet, Cash Flow (Last 3 years).
- **Derived Metrics (ê³„ì‚° í•„ìˆ˜):**
> **âš ï¸ ì—ëŸ¬ ì²˜ë¦¬ (í•„ìˆ˜):**
  > ì›ë³¸ ë°ì´í„°ê°€ ë¹„ì–´ìˆê±°ë‚˜(`None`, `NaN`), ë¶„ëª¨ê°€ `0`ì¸ ê²½ìš° **ì ˆëŒ€ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ì§€ ë§ ê²ƒ.**
  > ëŒ€ì‹  í•´ë‹¹ ì§€í‘œ ê°’ì„ ë¬¸ìì—´ **"N/A"** ë˜ëŠ” `None`ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ UIì— "Data Not Available"ë¡œ í‘œì‹œë˜ê²Œ í•¨.

  1. **Quality of Earnings:** `OCF / Net Income` (1.0 ë¯¸ë§Œ ì‹œ Warning).
  2. **Activity (Turnover):**
     - `Receivables Turnover` (Revenue / Receivables)
     - `Inventory Turnover` (COGS / Inventory) -> ì¶”ì„¸ í•˜ë½ ì‹œ Risk.
  3. **Stability:** `Interest Coverage Ratio` (EBIT / Interest Expense).
  4. **Growth/Capex:** `CapEx Growth` (ì„±ì¥ì£¼ì˜ ê²½ìš° ì¦ê°€ì„¸ í™•ì¸).
  5. **Shareholder Return:** `Net Buyback Yield` (Repurchaseê°€ ì–‘ìˆ˜ì¸ì§€ í™•ì¸).

#### C. Market Sentiment (`get_news_sentiment`)
- **Recent:** `ticker.news` (ìµœì‹  10ê±´). ì œëª©/ë§í¬/ê²Œì‹œì‹œê°„ ì¶”ì¶œ.
- **Historical (Event):** 1ë…„ ë‚´ ì£¼ê°€ ë³€ë™í­(Change %) ìƒìœ„ 5ì¼ ë‚ ì§œ ì¶”ì¶œ ë° í•´ë‹¹ì¼ í‚¤ì›Œë“œ ê²€ìƒ‰.

#### D. Technicals & Timing (`get_technicals`)
- **Library:** `pandas-ta` í™œìš©.
- **Indicators:**
  - `RSI(14)`: ê³¼ë§¤ìˆ˜(70)/ê³¼ë§¤ë„(30) íŒë³„.
  - `TRIX(30)`: ì¶”ì„¸ ì „í™˜ ì‹œê·¸ë„ (Signal ì„  êµì°¨).
  - `MA`: 20, 60, 120ì¼ ì´ë™í‰ê· ì„ .
  - `Volume`: 20ì¼ í‰ê·  ëŒ€ë¹„ í˜„ì¬ ê±°ë˜ëŸ‰ ë¹„ìœ¨.
- **Schedule:** `ticker.calendar` í™œìš©. Next Earnings Dateê¹Œì§€ ë‚¨ì€ ì¼ìˆ˜(D-Day) ê³„ì‚°.

---

## 5. AI Analyst Logic (Prompt Engineering)

**Role:** CIO (Macro Strategist) + Forensic Accountant.
**AI Engine:** Google Gemini API (`gemini-2.5-flash-lite`)

**System Prompt Structure:**
1. **Macro/Industry:** `info`ì˜ Country, Industry ê¸°ë°˜ìœ¼ë¡œ ê±°ì‹œê²½ì œ(ê¸ˆë¦¬, í™˜ìœ¨) ë° ì‚°ì—… ê²½ìŸêµ¬ë„(Moat, Value Chain) ë¶„ì„.
2. **Forensic Check:** ì œê³µëœ íšŒì „ìœ¨, OCF ë¹„ìœ¨ ë°ì´í„°ë¥¼ ê·¼ê±°ë¡œ "ì´ìµì˜ ì§ˆ" í‰ê°€. (íšŒê³„ ë¶€ì • ê°€ëŠ¥ì„± ì–¸ê¸‰).
3. **Strategy Fit:**
   - **Growth Mode:** ë§¤ì¶œ ì„±ì¥, PEG, CapEx í™•ì¥ì„± ì¤‘ì‹œ.
   - **Value Mode:** FCF, ë°°ë‹¹, ìì‚¬ì£¼ ë§¤ì…, ë¶€ì±„ ì¶•ì†Œ ì¤‘ì‹œ.
4. **Timing Verdict:**
   - Earnings D-7 ì´ë‚´ë©´ "Volatility Warning(ê´€ë§)" ê¶Œê³ .
   - RSI/TRIX/ë‰´ìŠ¤ ì‹¬ë¦¬ë¥¼ ì¢…í•©í•˜ì—¬ êµ¬ì²´ì  ì§„ì…ê°€($) ë° ë§¤ìˆ˜/ë§¤ë„/ë³´ë¥˜ ì œì•ˆ.

---

## 6. UI/UX Layout (Streamlit) - English Interface

### Sidebar
- **Title:** Stock Deep-Dive AI ğŸ“ˆ
- **Settings:** : Gemini API Key Input
- **Input:** `Enter Ticker (e.g., NVDA)`
- **Radio:** `Investment Style` [ğŸš€ Growth, ğŸ›¡ï¸ Value]
- **Button:** `Run Analysis`

### Main Area

#### Header
- Company Name | Ticker | Current Price (Change %)
- **AI Score:** (0~100 Badge) | **Verdict:** [ğŸŸ¢ STRONG BUY / ğŸŸ¡ HOLD / ğŸ”´ SELL]

#### Tab 1: Executive Summary
- **The Bottom Line:** 3-bullet summary (Key Strength, Main Risk, Action Plan).
- **Radar Chart:** Growth / Stability / Profitability / Momentum / Value.

#### Tab 2: Macro & Industry (The Context)
- **Macro Environment:** AI generated text on Country/Rates policies.
- **Industry & Moat:** Value chain position, Competition level.
- **Peer Comparison:** Simple metrics comparison table (if available in `info`).

#### Tab 3: Financial Health (The Numbers)
- **Forensic Check (Table):**
  - âœ… OCF > Net Income
  - âš ï¸ Inventory Turnover (Declining)
  - âœ… Interest Coverage (> 5.0)
- **Charts (Plotly):**
  - Bar: Revenue & Net Income (3yr)
  - Line: Free Cash Flow vs CapEx

#### Tab 4: Timing & Action (The Execution)
- **Price Chart:** Candlestick + MA Lines + **Event Pins (ğŸ“Œ)**.
- **Indicators:** RSI Sub-chart, TRIX Sub-chart.
- **Earnings Alert:** "ğŸ“… Next Earnings: Jan 24, 2025 (15 days left)"
- **News Feed:** List of recent headlines with Sentiment Tags [Positive/Negative].

---

## 7. Implementation Checklist

- [ ] **Step 1:** `StockDataManager` í´ë˜ìŠ¤ êµ¬í˜„ (yfinance ë°ì´í„° íŒ¨ì¹­ ë° ì—ëŸ¬ í•¸ë“¤ë§).
- [ ] **Step 2:** ì¬ë¬´ í¬ë Œì‹ ê³µì‹(íšŒì „ìœ¨ ë“±) ë° ê¸°ìˆ ì  ì§€í‘œ(TRIX ë“±) ì—°ì‚° ë¡œì§ êµ¬í˜„.
- [ ] **Step 3:** OpenAI API ì—°ë™ ë° `generate_analysis_report` í”„ë¡¬í”„íŠ¸ ìµœì í™”.
- [ ] **Step 4:** Streamlit UI ë ˆì´ì•„ì›ƒ êµ¬ì„± (Tabs, Charts).
- [ ] **Step 5:** í†µí•© í…ŒìŠ¤íŠ¸ (Growth/Value ëª¨ë“œ ë³„ ê²°ê³¼ ì°¨ë³„í™” í™•ì¸).